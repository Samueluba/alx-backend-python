#!/bin/bash

SCRIPT_PATH="messaging_app/kurbeScript"

# Check if script exists and is not empty
echo "🔍 Checking if $SCRIPT_PATH exists and is not empty..."
if [[ ! -f "$SCRIPT_PATH" ]]; then
    echo "❌ File $SCRIPT_PATH does not exist."
    exit 1
fi

if [[ ! -s "$SCRIPT_PATH" ]]; then
    echo "❌ File $SCRIPT_PATH is empty."
    exit 1
fi
echo "✅ $SCRIPT_PATH exists and is not empty."

# Check for Minikube installation check
echo "🔍 Checking for Minikube installation check..."
if grep -qE 'command -v.*minikube' "$SCRIPT_PATH"; then
    echo "✅ Script checks if Minikube is installed."
else
    echo "❌ Script does not check for Minikube installation."
fi

# Check for starting Kubernetes cluster
echo "🔍 Checking if script starts a Kubernetes cluster..."
if grep -q 'minikube start' "$SCRIPT_PATH"; then
    echo "✅ Script starts a Kubernetes cluster with Minikube."
else
    echo "❌ Script does not start a Kubernetes cluster."
fi

# Check for kubectl cluster-info
echo "🔍 Checking for cluster verification with kubectl..."
if grep -q 'kubectl cluster-info' "$SCRIPT_PATH"; then
    echo "✅ Script verifies the cluster with kubectl cluster-info."
else
    echo "❌ Script does not verify the cluster with kubectl cluster-info."
fi

# Check for kubectl get pods
echo "🔍 Checking if script retrieves pods..."
if grep -q 'kubectl get pods' "$SCRIPT_PATH"; then
    echo "✅ Script retrieves available pods using kubectl get pods."
else
    echo "❌ Script does not retrieve pods."
fi
